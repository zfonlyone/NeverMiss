# 任务5：任务标签和背景

## 需求描述
任务列表可以设置任务标签，任务列表的背景可以自定义。这将增强任务的可识别性和用户界面的个性化程度。

## 技术分析
当前的任务模型没有标签功能，且任务列表没有背景自定义选项。需要扩展数据模型和相应的UI组件。

## 实施计划

### 1. 更新任务模型支持标签
- 修改 `Task.ts` 模型，添加标签相关字段：
  ```typescript
  export interface Tag {
    id: number;
    name: string;
    color: string;
  }
  
  export interface Task {
    // 现有字段
    ...
    tags: Tag[];  // 新增标签字段
  }
  ```
- 更新存储服务，支持标签的持久化

### 2. 创建标签管理组件
- 创建 `components/widgets/TagManager.tsx` 组件
- 实现标签的创建、编辑、删除功能
- 支持自定义标签颜色
- 设计标签选择器组件，用于在任务表单中选择标签

### 3. 更新任务表单以支持标签
- 在 `TaskFormInline.tsx` 中集成标签选择器
- 添加标签添加/移除功能
- 实现多标签选择的 UI

### 4. 实现任务列表的标签显示
- 更新 `TaskList.tsx`，在任务项中显示标签
- 设计标签的视觉样式，确保清晰可见
- 支持通过标签筛选任务列表

### 5. 添加任务列表背景自定义功能
- 创建 `components/widgets/BackgroundSelector.tsx` 组件
- 支持以下背景选项：
  - 纯色背景
  - 渐变色背景
  - 图案背景
  - 用户自定义图片背景
- 实现背景预览功能

### 6. 更新设置页面
- 在设置页面中添加标签管理部分
- 添加背景设置部分
- 实现设置的保存和加载

### 7. 持久化存储
- 设计标签和背景设置的存储结构
- 更新 `storageService.ts` 支持新的数据结构
- 实现数据迁移，确保向后兼容

### 8. UI 和 UX 优化
- 确保标签和背景设置的 UI 直观易用
- 优化颜色选择器的用户体验
- 实现拖放操作来重新排序标签
- 提供标签使用频率的视觉反馈

## 相关文件
- `models/Task.ts` - 任务模型，需添加标签支持
- `components/TaskList.tsx` - 任务列表，需添加标签显示和背景支持
- `components/TaskFormInline.tsx` - 任务表单，需添加标签选择
- 待创建: `components/widgets/TagManager.tsx` - 标签管理组件
- 待创建: `components/widgets/BackgroundSelector.tsx` - 背景选择器组件
- `services/storageService.ts` - 存储服务，需更新支持新数据结构
- `app/settings.tsx` - 设置页面，需添加标签和背景设置

## 注意事项
- 标签功能要考虑性能影响，特别是在有大量任务时
- 背景选择要注意可访问性，确保文字内容在自定义背景上依然可读
- 提供默认的标签预设，减少用户初次使用时的配置负担
- 背景图片可能占用较大存储空间，需要考虑图片压缩或限制大小
- 标签系统应该支持导入/导出，跟随任务数据备份 